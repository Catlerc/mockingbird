import pathOr from '@tinkoff/utils/object/pathOr';
import currencies from '@platform-ui/money/currencies.json';
import { plural } from '@platform-ui/format-utils';
import { isEmptyValue } from './numberInputUtils/parse';

const currencySymbolOrSelf = currency => pathOr([currency, 'symbol'], currency, currencies);

const unitsPostfix = (value, units) => {
  let postfix;

  switch (true) {
    case typeof units === 'function':
      postfix = units(value);
      break;

    case isEmptyValue(value):
      return '';

    case Array.isArray(units):
      postfix = units[plural(value)];
      break;

    default:
      postfix = currencySymbolOrSelf(units);
  }

  return postfix ? `\u00A0${postfix}` : '';
};

export default unitsPostfix;