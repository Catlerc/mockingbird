import _extends from "@babel/runtime/helpers/extends";
import _objectWithoutPropertiesLoose from "@babel/runtime/helpers/objectWithoutPropertiesLoose";
const _excluded = ["tagName", "toBody", "to", "exitRef", "prerender", "children"];
import React from 'react';
import { createPortal } from 'react-dom';
import { findPortalExit, setRef } from './utils';

const Portal = props => {
  const {
    tagName = 'div',
    toBody,
    to = toBody ? 'body' : undefined,
    exitRef,
    prerender,
    children
  } = props,
        rest = _objectWithoutPropertiesLoose(props, _excluded);

  const [exit, setExit] = React.useState(null);
  const anchorRefCallback = React.useCallback(anchor => {
    if (!anchor) {
      setRef(exitRef, null);
      return;
    }

    const exitFound = findPortalExit(anchor, to);
    setExit(exitFound);
    setRef(exitRef, exitFound);
  }, [to, exitRef]);
  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(tagName, _extends({
    ref: anchorRefCallback,
    hidden: true
  }, rest), prerender && !exit ? children : null), exit && /*#__PURE__*/createPortal(children, exit));
};

export default Portal;