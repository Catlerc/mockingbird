"use strict";

exports.__esModule = true;
exports.setPositionStart = setPositionStart;

var maxOffsetTooltip = function maxOffsetTooltip(shift, offset, size, parentSize) {
  if (parentSize === void 0) {
    parentSize = 0;
  }

  var sign = shift >= 0 ? 1 : -1;
  var limitPlus = sign * (parentSize - offset);
  var limitMinus = sign * (size - offset);
  return shift >= 0 ? Math.min(limitPlus, shift) : Math.max(limitMinus, shift);
};

var maxOffsetArrow = function maxOffsetArrow(shift, offset, size, parentSize) {
  if (parentSize === void 0) {
    parentSize = 0;
  }

  var sign = shift >= 0 ? 1 : -1;
  var limitPlus = sign * (parentSize / 2 - offset);
  var limitMinus = sign * (size - parentSize / 2 - offset);
  return shift >= 0 ? Math.min(limitPlus, shift) : Math.max(limitMinus, shift);
};

var setHorizontal = function setHorizontal(_ref) {
  var childrenRect = _ref.childrenRect,
      popoverRect = _ref.popoverRect,
      direction = _ref.direction,
      additionalShift = _ref.additionalShift,
      customPadding = _ref.customPadding,
      minArrowOffset = _ref.minArrowOffset,
      containerOffsets = _ref.containerOffsets;
  return {
    tooltipStyle: {
      top: childrenRect.top + maxOffsetTooltip(additionalShift, minArrowOffset, popoverRect.height, childrenRect.height) + containerOffsets.top,
      left: direction === 'right' ? childrenRect.right + customPadding + containerOffsets.left : childrenRect.left - popoverRect.width - customPadding + containerOffsets.left
    },
    cornerStyle: {
      top: childrenRect.height / 2 - maxOffsetArrow(additionalShift, minArrowOffset, popoverRect.height, childrenRect.height)
    }
  };
};

var setVertical = function setVertical(_ref2) {
  var childrenRect = _ref2.childrenRect,
      containerRect = _ref2.containerRect,
      popoverRect = _ref2.popoverRect,
      direction = _ref2.direction,
      additionalShift = _ref2.additionalShift,
      customPadding = _ref2.customPadding,
      windowMargin = _ref2.windowMargin,
      minArrowOffset = _ref2.minArrowOffset,
      containerOffsets = _ref2.containerOffsets;
  var tooltipStyle = {
    top: direction === 'bottom' ? childrenRect.bottom + customPadding + containerOffsets.top : childrenRect.top - popoverRect.height - customPadding + containerOffsets.top,
    left: childrenRect.left + maxOffsetTooltip(additionalShift, minArrowOffset, popoverRect.width, childrenRect.width) + containerOffsets.left
  };
  var arrowLeft = childrenRect.width / 2;
  var cornerStyle = {
    left: arrowLeft - maxOffsetArrow(additionalShift, minArrowOffset, popoverRect.width, childrenRect.width)
  }; // не даем вылезти тултипу за экран

  var right = containerRect.width - (childrenRect.left + popoverRect.width + maxOffsetTooltip(additionalShift, minArrowOffset, popoverRect.width, childrenRect.width));
  var realWindowMargin = Math.min(windowMargin, containerRect.width - childrenRect.right);

  if (right < realWindowMargin) {
    tooltipStyle.left = containerRect.width - popoverRect.width - realWindowMargin;
    cornerStyle.marginLeft = -right + realWindowMargin;
  }

  return {
    tooltipStyle: tooltipStyle,
    cornerStyle: cornerStyle
  };
};

function setPositionStart(args) {
  switch (args.direction) {
    case 'left':
    case 'right':
      return setHorizontal(args);

    case 'top':
    case 'bottom':
      return setVertical(args);
  }
}